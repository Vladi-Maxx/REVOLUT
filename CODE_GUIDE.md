# Ръководство за кода в Revolut Dashboard

## Принципи на разработка

### Принцип за единична отговорност (SRP)
- Всеки клас/модул трябва да има само една причина да се променя
- Функциите и методите трябва да изпълняват само една конкретна задача

### Модулност
- Компонентите трябва да бъдат слабо свързани помежду си
- Използвайте инжектиране на зависимости вместо директно създаване

```javascript
// Препоръчително: Инжектиране на зависимост
class ChartComponent {
    constructor(dataService) {
        this.dataService = dataService;
    }
}
```

### DRY (Don't Repeat Yourself)
- Избягвайте дублиране на код чрез създаване на споделени функции
- Използвайте utility класове за често използвана функционалност

### KISS (Keep It Simple, Stupid)
- Предпочитайте прости и ясни решения пред сложни
- Четимостта е по-важна от "умни" трикове

## Организация на кода

### Структура на директориите
- `/src/components/` - UI компоненти
- `/src/services/` - Услуги за достъп до данни
- `/src/utils/` - Помощни функции и класове
- `/src/views/` - Основни изгледи

### Именуване на файлове
- **Компоненти**: PascalCase (`ChartComponent.js`)
- **Utility модули**: camelCase (`dataUtils.js`)
- **Изгледи**: camelCase + "View" (`dashboardView.js`)
- **Сервизи**: camelCase + "Service" (`supabaseService.js`)

## Стандарти за кода

### Форматиране
- **Отстъп**: 4 интервала
- **Максимална дължина на ред**: ~100 символа
- **Къдрави скоби**: на същия ред като оператора

### Именуване

#### Променливи и функции
- Използвайте camelCase и описателни имена
- Избягвайте съкращения, освен ако не са общоприети (напр. URL, ID)

```javascript
// Добре
const transactionAmount = 100;
function calculateTotalAmount() { /* ... */ }

// Избягвайте
const a = 100;
function calc() { /* ... */ }
```

#### Класове
- Използвайте PascalCase за имена на класове
- Имената трябва да бъдат съществителни или именни фрази

#### Константи
- Използвайте UPPER_SNAKE_CASE за константи
- Пример: `const MAX_TRANSACTIONS = 1000;`

#### Приватни членове
- Използвайте префикс "_" за приватни полета и методи
- Пример: `this._transactions = [];`

### Коментари
- Добавяйте JSDoc коментари за класове и методи
- Коментирайте сложен или неинтуитивен код
- Избягвайте очевидни коментари

```javascript
/**
 * Филтрира транзакции по зададени критерии
 * @param {Array} transactions - Масив с транзакции
 * @param {Object} filters - Обект с филтри
 * @returns {Array} Филтрирани транзакции
 */
```

## Работа с асинхронен код

### Promises и async/await
- Предпочитайте async/await пред верижни .then()
- Използвайте try/catch за обработка на грешки

```javascript
// Препоръчително
async function loadTransactions() {
    try {
        const data = await supabaseService.getAllTransactions();
        return processTransactions(data);
    } catch (error) {
        console.error('Error loading transactions:', error);
        throw error;
    }
}
```

### Обработка на грешки
- Винаги обработвайте грешки при асинхронни операции
- Логвайте грешки с подходящо ниво на детайлност
- Предавайте грешки нагоре, когато е подходящо

## UI компоненти

### Структура на компонент
- Разделете компонентите на логически секции: инициализация, събития, рендериране
- Използвайте ясно именувани методи, които отразяват отговорността им

### Взаимодействие между компоненти
- Използвайте callback функции за комуникация между компоненти
- Избягвайте директни референции между компоненти

```javascript
// Пример за callback между компоненти
const chartComponent = new ChartComponent({
    onDataSelect: (selectedData) => {
        tableComponent.filterByData(selectedData);
    }
});
```

## Дебъгване и логване

### Логване
- Използвайте информативни съобщения с контекст
- В production код премахвайте излишните логове

```javascript
console.log('[FilterManager] Applying filters:', filters);
```

### Трейсиране на грешки
- Включвайте подходяща информация в съобщения за грешки
- Не скривайте грешки без причина

## Оптимизация

### Производителност
- Избягвайте ненужни пресмятания в цикли
- Кеширайте стойности, които се използват многократно
- Минимизирайте DOM манипулациите

### Памет
- Изчиствайте слушатели на събития, когато не са нужни
- Освобождавайте референции към големи обекти, когато не се използват

## Специфични за проекта конвенции

### FilterManager
- Използвайте `applyFilters` метода за всички промени на филтри
- Винаги извиквайте callback функцията `onFilterSuccess` след успешно филтриране

### Компоненти за графики
- Всеки компонент за графика трябва да има методи `initChart` и `updateChart`
- Използвайте `DataUtils.prepareChartData` за подготовка на данни

### Работа със Supabase
- Винаги обработвайте грешки от Supabase API
- За големи набори от данни използвайте пагинация